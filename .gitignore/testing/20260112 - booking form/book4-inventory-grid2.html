<!-- Product Card (copy/paste) -->
<style>






  /* Grid wrapper */
  .rr-inventory-section { padding: 18px 0; }
  .rr-inventory-header { display:flex; align-items:baseline; justify-content:space-between; gap:12px; }
  .rr-inventory-title { margin:0; font-size: 22px; }
  .rr-inventory-status { font-size: 14px; opacity: 0.8; }

  .rr-inventory-grid{
    margin-top: 14px;
    display: flex;
	flex-wrap:wrap;
	justify-content:space-evenly;
    gap: 18px;
  }


  .rr-card{
    background:#fff;
    border-radius: 0;
    overflow:hidden;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
	flex: 1 1 100%;
  }

  .rr-card__img-wrap{
    padding:8px;
    background:#fff;
  }

  .rr-card__img{
    width:100%;
    aspect-ratio: 4 / 3;
    object-fit: cover;
    display:block;
  }

  .rr-card__body{
    text-align:center;
    padding:5px 5px 10px 5px;
  }

  .rr-card__name{
    font-size: 22px;
    color:#505050;
    line-height:1.1;
    margin-bottom:4px;
  }

  .rr-card__price{
    font-size: 20px;
    color:#505050;
    line-height:1.1;
  }
  
  .rr-btn-addToCart{
	background-color: white;
    padding: 10px;
    border-color: gray;
    border-width: 1px;
    font-size: 1em;
    margin-top: 5px;
  }

	.rr-btn-addToCart:Hover{
		background-color: #8b0000;
		color: white;
	}


	@media (min-width: 600px) {
	  .rr-card{
		/* On screens 600px and wider, items can take up about a third of the width */
		/* flex-basis is calculated to fit multiple items with gaps */
		flex: 1 1 calc(50% - 16px);
		max-width: calc(50% - 16px);
	  }
	}

	@media (min-width: 900px) {
	  .rr-card{
		 /* On screens 900px and wider, items can take up about a quarter of the width */
		flex: 1 1 calc(33.33% - 16px);
		max-width: calc(33.33% - 16px);
	  }
	}



</style>



<!-- Inventory Grid -->
<section class="rr-inventory-section">
  <div class="rr-inventory-header">
    <h2 class="rr-inventory-title">Available Inventory</h2>
    <div id="rrInventoryStatus" class="rr-inventory-status">Loading…</div>
  </div>

  <div id="rrInventoryGrid" class="rr-inventory-grid"></div>
</section>

<!-- Card Template (hidden) -->
<template id="rrItemTemplate">
  <div class="rr-card">
    <div class="rr-card__img-wrap">
      <img class="rr-card__img" alt="" loading="lazy" />
    </div>

    <div class="rr-card__body">
      <div class="rr-card__name"></div>
      <div class="rr-card__addToCart"></div>
    </div>
  </div>
</template>



<script>
  (function () {
    const ENDPOINT =
      "https://script.google.com/macros/s/AKfycbwiQbTdtwT0VtIIxGVDnu1IP9q6JXnL6zIhWe7wsnM2O9laf4OProuyfzi9PafriDEoUw/exec?action=inventory";

    const grid = document.getElementById("rrInventoryGrid");
    const statusEl = document.getElementById("rrInventoryStatus");
    const tpl = document.getElementById("rrItemTemplate");

    const money = (value) => {
      const n = Number(value);
      if (!Number.isFinite(n)) return "";
      // If you want always "$X" (no decimals):
      return "$" + (Number.isInteger(n) ? n : n.toFixed(2));
    };

    const safeText = (v) => (v == null ? "" : String(v));

    async function loadInventory() {
      statusEl.textContent = "Loading…";

      try {
        const res = await fetch(ENDPOINT, { cache: "no-store" });
        if (!res.ok) throw new Error("HTTP " + res.status);

        const data = await res.json();
        if (!data || !Array.isArray(data.inventory)) {
          throw new Error("Unexpected response shape (no inventory array)");
        }

        renderInventory(data.inventory);
        statusEl.textContent = `Loaded ${data.inventory.length} item(s)`;
      } catch (err) {
        console.error(err);
        statusEl.textContent = "Couldn’t load inventory.";
        grid.innerHTML = `
          <div style="padding:14px;border:1px solid #ddd;">
            <strong>Inventory load failed.</strong><br/>
            Please try again or check the Apps Script deployment / CORS.
          </div>
        `;
      }
    }

    function renderInventory(items) {
      grid.innerHTML = "";

      items.forEach((item) => {
        // Your JSON keys (with spaces) based on the screenshot:
        const name = safeText(item["Item Name"]);
        const priceRaw = item["Rental Price"];
		const priceText = money(priceRaw);
        const qty = Number(item["Quantity Available"]);
        const imgUrl = safeText(item["Image"]);
		const lblNamePrice = name + " - " + priceText;
        const node = tpl.content.firstElementChild.cloneNode(true);

        // Image
        const img = node.querySelector(".rr-card__img");
        img.src = imgUrl || "https://redrockpartyrentals.com/images/placeholder.jpg";
        img.alt = name || "Inventory Item";

        // Name
        node.querySelector(".rr-card__name").textContent = lblNamePrice || "Unnamed Item";

        // Price (format like "$3 each")
        const AddToCartEl = node.querySelector(".rr-card__addToCart");

        AddToCartEl.innerHTML = `<button class="rr-btn-addToCart">Add To Cart</button>`;

        // Optional: mark unavailable
        if (Number.isFinite(qty) && qty <= 0) node.classList.add("is-unavailable");

        grid.appendChild(node);
      });
    }

    // Kick off
    loadInventory();
  })();
</script>